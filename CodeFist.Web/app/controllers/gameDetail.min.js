(function(){var n;n=angular.module("codefist");n.controller("GameDetailCtrl",["$scope","$modal","$routeParams","$location","session","gameService","botService","matchService",function(n,t,i,r,u,f,e,o){var s;return n.gameId=i.gameId,f.get(n.gameId).then(function(t){return n.game=t.data}),e.queryByGame(n.gameId).then(function(t){var i;return i=t.data,n.bots=i,n.fightBots=[{botId:i[Math.floor(Math.random()*i.length)].botId},{botId:i[Math.floor(Math.random()*i.length)].botId}]}),o.queryByGame(n.gameId).then(function(t){return n.matches=t.data}),u.initializeScope(n),n.scripts=[{name:"gameSource",label:"Game Source"},{name:"botSource",label:"Sample Bot Source"},{name:"visualizerSource",label:"Visualizer Source"}],n.activeScriptName="",n.editorOptions={mode:"javascript",indentUnit:4,tabMode:"spaces",lineNumbers:!0,lint:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"]},n.saveChanges=function(){return f.update(n.game)},n.editScript=function(t){return n.activeScriptName=n.activeScriptName===t?null:t},n.tabClass=function(t){return n.activeScriptName===t?"btn-primary":"btn-default"},n.createBot=function(){var n;return n=t.open({templateUrl:"/app/views/dialogs/create-bot.html",controller:"CreateBotCtrl"}),n.result.then(function(n){return r.path("games/"+n.gameId+"/bots/"+n.botId)})},n.fightRanked=function(){var t;return t=n.fightBots.map(function(n){return n.botId}),o.create(n.gameId,t).then(function(n){return r.path("/matches/"+n.data)})},n.fightLocal=function(){var t;return t=n.fightBots.map(function(n){return n.botId}),r.path("/games/"+n.gameId+"/fight/"+t.join())},s=function(n,t,i){return i.indexOf(n)===t},n.canFightRanked=function(){return n.fightBots!=null&&n.fightBots.map(function(n){return n.botId}).filter(s).length===n.fightBots.length}}])}).call(this)