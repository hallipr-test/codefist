(function(){var n;n=angular.module("codefist");n.controller("LocalFightCtrl",["$scope","gameService","botService","$routeParams","$q",function(n,t,i,r,u){var e,o,s,f;return n.gameId=r.gameId,n.players=[],e=r.botIds.split(","),n.settings={refreshRate:1e3/60,speed:1},s=t.get(n.gameId).then(function(t){return n.game=t.data}),o=e.map(function(t,r){return i.get(n.gameId,t).then(function(t){return n.players[r]=t.data})}),u.all([s].concat(o)).then(function(){var o,s,h,c,i,t,r,l,a,v,u,e,y,p;for(t={},n.players.forEach(function(n){return t.hasOwnProperty(n.botId)||(t[n.botId]=[]),t[n.botId].push(n)}),u=0,y=t.length;u<y;u++)if(i=t[u],i.length>1)for(r=e=0,p=i.length;e<p;r=++e)s=i[r],s.botId+=" ("+r+")";return c=n.game.gameSource,v=n.game.visualizerSource,o=f(c,"Game"),h=new o,l=n.players.map(function(n){return{botId:n.botId,constructor:f(n.source,"Player")}}),a=performance.now(),h.play(l,function(t,i){var r,u;return i.elapsed=performance.now()-a,r=f(v,"Visualizer"),u=new r(i,document.getElementById("playback"),n.settings),u.play()})}),f=function(n,t){var i;return i=new Function("global","return function(){"+n+"; return "+t+";}.call(global);"),i({})}}])}).call(this)